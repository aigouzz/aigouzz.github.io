<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React源码解析 | React源码解析</title>
    <meta name="description" content="react vitepress vite react-router redux">
    <link rel="stylesheet" href="/react/assets/style.c1f85080.css">
    <link rel="modulepreload" href="/react/assets/app.c44872b6.js">
    <link rel="modulepreload" href="/react/assets/intro_4.md.7555dd74.lean.js">
    
    <link rel="icon" href="https://aigouzz.github.io/dist/logo.png">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-0dd73670><!--[--><!--]--><!--[--><span tabindex="-1" data-v-b45a8805></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-b45a8805> Skip to content </a><!--]--><!----><header class="VPNav" data-v-0dd73670 data-v-b71ddd30><div class="VPNavBar has-sidebar" data-v-b71ddd30 data-v-eccc28dd><div class="container" data-v-eccc28dd><div class="VPNavBarTitle has-sidebar" data-v-eccc28dd data-v-4208b882><a class="title" href="/react/" data-v-4208b882><!--[--><!--]--><!--[--><img class="VPImage logo" src="/react/logo.png" alt data-v-f50c4392><!--]--><!--[-->React源码解析<!--]--><!--[--><!--]--></a></div><div class="content" data-v-eccc28dd><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-eccc28dd data-v-696ccc98><span id="main-nav-aria-label" class="visually-hidden" data-v-696ccc98>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="https://aigouzz.github.io/dist" target="_blank" rel="noreferrer" data-v-696ccc98 data-v-644fa046 data-v-67783dc9><!--[-->前端架构<!--]--><!----></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-696ccc98 data-v-a6dd6545><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-a6dd6545><span class="text" data-v-a6dd6545><!----> 源码解析 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-a6dd6545><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-a6dd6545><div class="VPMenu" data-v-a6dd6545 data-v-857bd1d4><div class="items" data-v-857bd1d4><!--[--><!--[--><div class="VPMenuLink" data-v-857bd1d4 data-v-4989b3bb><a class="VPLink link" href="https://aigouzz.github.io/vue2" target="_blank" rel="noreferrer" data-v-4989b3bb data-v-67783dc9><!--[-->Vue2<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-67783dc9><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-857bd1d4 data-v-4989b3bb><a class="VPLink link" href="https://aigouzz.github.io/vue3" target="_blank" rel="noreferrer" data-v-4989b3bb data-v-67783dc9><!--[-->Vue3<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-67783dc9><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-857bd1d4 data-v-4989b3bb><a class="VPLink link" href="https://aigouzz.github.io/react" target="_blank" rel="noreferrer" data-v-4989b3bb data-v-67783dc9><!--[-->React<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-67783dc9><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-857bd1d4 data-v-4989b3bb><a class="VPLink link" href="https://aigouzz.github.io/redux" target="_blank" rel="noreferrer" data-v-4989b3bb data-v-67783dc9><!--[-->Redux<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-67783dc9><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-857bd1d4 data-v-4989b3bb><a class="VPLink link" href="https://aigouzz.github.io/webpack" target="_blank" rel="noreferrer" data-v-4989b3bb data-v-67783dc9><!--[-->Webpack<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-67783dc9><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-857bd1d4 data-v-4989b3bb><a class="VPLink link" href="https://aigouzz.github.io/algorithm" target="_blank" rel="noreferrer" data-v-4989b3bb data-v-67783dc9><!--[-->Algorithm<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-67783dc9><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="https://aigouzz.github.io/shop" target="_blank" rel="noreferrer" data-v-696ccc98 data-v-644fa046 data-v-67783dc9><!--[-->商铺项目<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="https://aigouzz.github.io/music" target="_blank" rel="noreferrer" data-v-696ccc98 data-v-644fa046 data-v-67783dc9><!--[-->听音乐<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-eccc28dd data-v-dd448478><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-dd448478 data-v-abbbf13a data-v-8b63d125><span class="check" data-v-8b63d125><span class="icon" data-v-8b63d125><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-abbbf13a><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-abbbf13a><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-eccc28dd data-v-58029811 data-v-a6dd6545><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-a6dd6545><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-a6dd6545><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-a6dd6545><div class="VPMenu" data-v-a6dd6545 data-v-857bd1d4><!----><!--[--><!--[--><!----><div class="group" data-v-58029811><div class="item appearance" data-v-58029811><p class="label" data-v-58029811>Appearance</p><div class="appearance-action" data-v-58029811><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-58029811 data-v-abbbf13a data-v-8b63d125><span class="check" data-v-8b63d125><span class="icon" data-v-8b63d125><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-abbbf13a><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-abbbf13a><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-eccc28dd data-v-3ea288f5><span class="container" data-v-3ea288f5><span class="top" data-v-3ea288f5></span><span class="middle" data-v-3ea288f5></span><span class="bottom" data-v-3ea288f5></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-0dd73670 data-v-6b8a8242><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-6b8a8242><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-6b8a8242><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-6b8a8242>Menu</span></button><a class="top-link" href="#" data-v-6b8a8242> Return to top </a></div><aside class="VPSidebar" data-v-0dd73670 data-v-8311cc44><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-8311cc44><span class="visually-hidden" id="sidebar-aria-label" data-v-8311cc44> Sidebar Navigation </span><!--[--><div class="group" data-v-8311cc44><section class="VPSidebarGroup collapsible" data-v-8311cc44 data-v-69237d58><div class="title" role="button" data-v-69237d58><h2 class="title-text" data-v-69237d58>前言</h2><div class="action" data-v-69237d58><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-69237d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-69237d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-69237d58><!--[--><!--[--><a class="VPLink link link" href="/react/intro/1.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>API</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/intro/2.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>ReactElement</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/intro/3.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>React Children</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link active" href="/react/intro/4.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>数据结构</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-8311cc44><section class="VPSidebarGroup collapsible" data-v-8311cc44 data-v-69237d58><div class="title" role="button" data-v-69237d58><h2 class="title-text" data-v-69237d58>创建更新</h2><div class="action" data-v-69237d58><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-69237d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-69237d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-69237d58><!--[--><!--[--><a class="VPLink link link" href="/react/update/1.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>ReactDOM.render</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/update/2.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>setState &amp; forceUpdate</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/update/3.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>expirationTime计算</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-8311cc44><section class="VPSidebarGroup collapsible" data-v-8311cc44 data-v-69237d58><div class="title" role="button" data-v-69237d58><h2 class="title-text" data-v-69237d58>任务调度</h2><div class="action" data-v-69237d58><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-69237d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-69237d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-69237d58><!--[--><!--[--><a class="VPLink link link" href="/react/schedule/1.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>全局变量</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/2.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>scheduleWork</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/3.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>react-schedule</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/4.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>performWork</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/5.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>performUnitOfWork</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/6.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>renderRoot</span><!--]--><!----></a><!--[--><!--[--><a class="VPLink link link" href="/react/schedule/7.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>throwException</span><!--]--><!----></a><!----><!--]--><!--]--><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/8.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>beginWork</span><!--]--><!----></a><!--[--><!--[--><a class="VPLink link link" href="/react/schedule/9.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>mountIndeterminateComponent</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/10.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>mountLazyComponent</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/11.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>updateFunctionalComponent</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/12.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>updateClassComponent</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/13.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>updateHostRoot</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/14.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>updateHostComponent</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/15.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>updateHostText</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/16.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>updateSuspenseComponent</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/17.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>updatePortalComponent</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/18.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>updateForwardRef</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/19.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>updateFragment</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/20.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>updateMode</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/21.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>updateProfile</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/22.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>updateContextProvider</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/23.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>updateContextConsumer</span><!--]--><!----></a><!----><!--]--><!--]--><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/24.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>reconcileChildren</span><!--]--><!----></a><!--[--><!--[--><a class="VPLink link link" href="/react/schedule/25.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>调和单个节点</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/schedule/26.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>调和列表</span><!--]--><!----></a><!----><!--]--><!--]--><!--]--><!--]--></div></section></div><div class="group" data-v-8311cc44><section class="VPSidebarGroup collapsible" data-v-8311cc44 data-v-69237d58><div class="title" role="button" data-v-69237d58><h2 class="title-text" data-v-69237d58>commit阶段</h2><div class="action" data-v-69237d58><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-69237d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-69237d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-69237d58><!--[--><!--[--><a class="VPLink link link" href="/react/commit/1.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>commitRoot</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/commit/2.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>invokeGuardedCallback</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/commit/3.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>commitBeforeMutationLifecycles</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/commit/4.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>commitAllHostEffects</span><!--]--><!----></a><!--[--><!--[--><a class="VPLink link link" href="/react/commit/5.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>commitPlacement</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/commit/6.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>commitWork</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/commit/7.html" style="padding-left:16px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text light" data-v-10e7fe7a>commitDeletion</span><!--]--><!----></a><!----><!--]--><!--]--><!--]--><!--[--><a class="VPLink link link" href="/react/commit/8.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>commitAllLifecycle</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-8311cc44><section class="VPSidebarGroup collapsible" data-v-8311cc44 data-v-69237d58><div class="title" role="button" data-v-69237d58><h2 class="title-text" data-v-69237d58>功能</h2><div class="action" data-v-69237d58><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-69237d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-69237d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-69237d58><!--[--><!--[--><a class="VPLink link link" href="/react/func/1.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>context</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/func/2.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>hydrate</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/func/3.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>ref</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/func/4.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>事件系统初始化</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/func/5.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>事件绑定</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/func/6.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>事件触发</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/func/7.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>事件对象生成</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/func/8.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>Suspense</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/func/9.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>挂起任务的含义</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/func/10.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>lazy组件</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-8311cc44><section class="VPSidebarGroup collapsible" data-v-8311cc44 data-v-69237d58><div class="title" role="button" data-v-69237d58><h2 class="title-text" data-v-69237d58>Hooks</h2><div class="action" data-v-69237d58><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-69237d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-69237d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-69237d58><!--[--><!--[--><a class="VPLink link link" href="/react/hooks/1.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>开始</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/hooks/2.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>useState</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/hooks/3.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>useEffect</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/hooks/4.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>其他api</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/react/hooks/5.html" style="padding-left:0px;" data-v-10e7fe7a data-v-67783dc9><!--[--><span class="link-text" data-v-10e7fe7a>通用api</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-0dd73670 data-v-e5c4cdba><div class="VPDoc has-sidebar has-aside" data-v-e5c4cdba data-v-bd22cb21><div class="container" data-v-bd22cb21><div class="aside" data-v-bd22cb21><div class="aside-curtain" data-v-bd22cb21></div><div class="aside-container" data-v-bd22cb21><div class="aside-content" data-v-bd22cb21><div class="VPDocAside" data-v-bd22cb21 data-v-76ddb78d><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-76ddb78d data-v-71bbc13b><div class="content" data-v-71bbc13b><div class="outline-marker" data-v-71bbc13b></div><div class="outline-title" data-v-71bbc13b>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-71bbc13b><span class="visually-hidden" id="doc-outline-aria-label" data-v-71bbc13b> Table of Contents for current page </span><ul class="root" data-v-71bbc13b data-v-c04a736d><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-76ddb78d></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-bd22cb21><div class="content-container" data-v-bd22cb21><!--[--><!--]--><main class="main" data-v-bd22cb21><div style="position:relative;" class="vp-doc _react_intro_4" data-v-bd22cb21><div><!----><h2 id="fiberroot" tabindex="-1">FiberRoot <a class="header-anchor" href="#fiberroot" aria-hidden="true">#</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BaseFiberRootProperties</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{|</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;">// root节点，render方法接收的第二个参数</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">containerInfo</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 只有在持久更新中会用到，也就是不支持增量更新的平台，react-dom不会用到</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">pendingChildren</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 当前应用对应的Fiber对象，是Root Fiber</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">current</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Fiber</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 一下的优先级是用来区分</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 1) 没有提交(committed)的任务</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 2) 没有提交的挂起任务</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 3) 没有提交的可能被挂起的任务</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 我们选择不追踪每个单独的阻塞登记，为了兼顾性能</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// The earliest and latest priority levels that are suspended from committing.</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 最老和新的在提交的时候被挂起的任务</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">earliestSuspendedTime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ExpirationTime</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">latestSuspendedTime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ExpirationTime</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// The earliest and latest priority levels that are not known to be suspended.</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 最老和最新的不确定是否会挂起的优先级（所有任务进来一开始都是这个状态）</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">earliestPendingTime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ExpirationTime</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">latestPendingTime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ExpirationTime</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// The latest priority level that was pinged by a resolved promise and can</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// be retried.</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 最新的通过一个promise被reslove并且可以重新尝试的优先级</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">latestPingedTime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ExpirationTime</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 如果有错误被抛出并且没有更多的更新存在，我们尝试在处理错误前同步重新从头渲染</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 在`renderRoot`出现无法处理的错误时会被设置为`true`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">didError</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">boolean</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 正在等待提交的任务的`expirationTime`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">pendingCommitExpirationTime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ExpirationTime</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 已经完成的任务的FiberRoot对象，如果你只有一个Root，那他永远只可能是这个Root对应的Fiber，或者是null</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 在commit阶段只会处理这个值对应的任务</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">finishedWork</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Fiber</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 在任务被挂起的时候通过setTimeout设置的返回内容，用来下一次如果有新的任务挂起时清理还没触发的timeout</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">timeoutHandle</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TimeoutHandle</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">NoTimeout</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 顶层context对象，只有主动调用`renderSubtreeIntoContainer`时才会有用</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">context</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">pendingContext</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Object</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 用来确定第一次渲染的时候是否需要融合</span></span>
<span class="line"><span style="color:#A6ACCD;">  +</span><span style="color:#F07178;">hydrate</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">boolean</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 当前root上剩余的过期时间</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// TODO: 提到renderer里面区处理</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nextExpirationTimeToWorkOn</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ExpirationTime</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 当前更新对应的过期时间</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">expirationTime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ExpirationTime</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// List of top-level batches. This list indicates whether a commit should be</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// deferred. Also contains completion callbacks.</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// TODO: Lift this into the renderer</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 顶层批次（批处理任务？）这个变量指明一个commit是否应该被推迟</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 同时包括完成之后的回调</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 貌似用在测试的时候？</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">firstBatch</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Batch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// root之间关联的链表结构</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nextScheduledRoot</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FiberRoot</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">|};</span></span>
<span class="line"></span></code></pre></div><h2 id="fiber" tabindex="-1">Fiber <a class="header-anchor" href="#fiber" aria-hidden="true">#</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// Fiber对应一个组件需要被处理或者已经处理了，一个组件可以有一个或者多个Fiber</span></span>
<span class="line"><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Fiber</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{|</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;">// 标记不同的组件类型</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">tag</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WorkTag</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// ReactElement里面的key</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// ReactElement.type，也就是我们调用`createElement`的第一个参数</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">elementType</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// The resolved function/class/ associated with this fiber.</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 异步组件resolved之后返回的内容，一般是`function`或者`class`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// The local state associated with this fiber.</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 跟当前Fiber相关本地状态（比如浏览器环境就是DOM节点）</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">stateNode</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 指向他在Fiber节点树中的`parent`，用来在处理完这个节点之后向上返回</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">return</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Fiber</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 单链表树结构</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 指向自己的第一个子节点</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">child</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Fiber</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 指向自己的兄弟结构</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 兄弟节点的return指向同一个父节点</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">sibling</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Fiber</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">index</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">number</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// ref属性</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">ref</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> ((</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">handle</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">mixed</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">void</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">_stringRef</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">?</span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RefObject</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 新的变动带来的新的props</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">pendingProps</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 上一次渲染完成之后的props</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">memoizedProps</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 该Fiber对应的组件产生的Update会存放在这个队列里面</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">updateQueue</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">UpdateQueue</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 上一次渲染的时候的state</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">memoizedState</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 一个列表，存放这个Fiber依赖的context</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">firstContextDependency</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ContextDependency</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">mixed</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 用来描述当前Fiber和他子树的`Bitfield`</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 共存的模式表示这个子树是否默认是异步渲染的</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// Fiber被创建的时候他会继承父Fiber</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 其他的标识也可以在创建的时候被设置</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 但是在创建之后不应该再被修改，特别是他的子Fiber创建之前</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">mode</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">TypeOfMode</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// Effect</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 用来记录Side Effect</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">effectTag</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">SideEffectTag</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 单链表用来快速查找下一个side effect</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nextEffect</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Fiber</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 子树中第一个side effect</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">firstEffect</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Fiber</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 子树中最后一个side effect</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">lastEffect</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Fiber</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 代表任务在未来的哪个时间点应该被完成</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 不包括他的子树产生的任务</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">expirationTime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ExpirationTime</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 快速确定子树中是否有不在等待的变化</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">childExpirationTime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ExpirationTime</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 在Fiber树更新的过程中，每个Fiber都会有一个跟其对应的Fiber</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 我们称他为`current &lt;==&gt; workInProgress`</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 在渲染完成之后他们会交换位置</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">alternate</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Fiber</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 下面是调试相关的，收集每个Fiber和子树渲染时间的</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">actualDuration</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">number</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// If the Fiber is currently active in the &quot;render&quot; phase,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// This marks the time at which the work began.</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// This field is only set when the enableProfilerTimer flag is enabled.</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">actualStartTime</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">number</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// Duration of the most recent render time for this Fiber.</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// This value is not updated when we bailout for memoization purposes.</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// This field is only set when the enableProfilerTimer flag is enabled.</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">selfBaseDuration</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">number</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// Sum of base times for all descedents of this Fiber.</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// This value bubbles up during the &quot;complete&quot; phase.</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// This field is only set when the enableProfilerTimer flag is enabled.</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">treeBaseDuration</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">number</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// Conceptual aliases</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// workInProgress : Fiber -&gt;  alternate The alternate used for reuse happens</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// to be the same as work in progress.</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// __DEV__ only</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">_debugID</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">number</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">_debugSource</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Source</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">_debugOwner</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Fiber</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">_debugIsCurrentlyTiming</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">boolean</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">|};</span></span>
<span class="line"></span></code></pre></div><h2 id="effecttags" tabindex="-1">effectTags <a class="header-anchor" href="#effecttags" aria-hidden="true">#</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * Copyright (c) Facebook, Inc. and its affiliates.</span></span>
<span class="line"><span style="color:#676E95;"> *</span></span>
<span class="line"><span style="color:#676E95;"> * This source code is licensed under the MIT license found in the</span></span>
<span class="line"><span style="color:#676E95;"> * LICENSE file in the root directory of this source tree.</span></span>
<span class="line"><span style="color:#676E95;"> *</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">flow</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">SideEffectTag</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">number</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// Don&#39;t change these two values. They&#39;re used by React Dev Tools.</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> NoEffect </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*              */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000000000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> PerformedWork </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*         */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000000001</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// You can change the rest (and add more).</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Placement </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*             */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000000010</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Update </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*                */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000000100</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> PlacementAndUpdate </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*    */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000000110</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Deletion </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*              */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000001000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ContentReset </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*          */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000010000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Callback </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*              */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000100000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> DidCapture </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*            */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00001000000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Ref </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*                   */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00010000000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Snapshot </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*              */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00100000000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// Update &amp; Callback &amp; Ref &amp; Snapshot</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> LifecycleEffectMask </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*   */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00110100100</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// Union of all host effects</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> HostEffectMask </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*        */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00111111111</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Incomplete </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*            */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b01000000000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ShouldCapture </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*         */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b10000000000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="reactworktag" tabindex="-1">ReactWorkTag <a class="header-anchor" href="#reactworktag" aria-hidden="true">#</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> FunctionComponent </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ClassComponent </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> IndeterminateComponent </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// Before we know whether it is function or class</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> HostRoot </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// Root of a host tree. Could be nested inside another node.</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> HostPortal </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// A subtree. Could be an entry point to a different renderer.</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> HostComponent </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> HostText </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">6</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Fragment </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">7</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Mode </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ContextConsumer </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ContextProvider </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ForwardRef </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">11</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Profiler </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">12</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> SuspenseComponent </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">13</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> MemoComponent </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">14</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> SimpleMemoComponent </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">15</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> LazyComponent </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">16</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> IncompleteClassComponent </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">17</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="sideeffects" tabindex="-1">sideEffects <a class="header-anchor" href="#sideeffects" aria-hidden="true">#</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * Copyright (c) Facebook, Inc. and its affiliates.</span></span>
<span class="line"><span style="color:#676E95;"> *</span></span>
<span class="line"><span style="color:#676E95;"> * This source code is licensed under the MIT license found in the</span></span>
<span class="line"><span style="color:#676E95;"> * LICENSE file in the root directory of this source tree.</span></span>
<span class="line"><span style="color:#676E95;"> *</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">flow</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">SideEffectTag</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">number</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// Don&#39;t change these two values. They&#39;re used by React Dev Tools.</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> NoEffect </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*              */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000000000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> PerformedWork </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*         */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000000001</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// You can change the rest (and add more).</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Placement </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*             */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000000010</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Update </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*                */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000000100</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> PlacementAndUpdate </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*    */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000000110</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Deletion </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*              */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000001000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ContentReset </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*          */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000010000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Callback </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*              */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00000100000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> DidCapture </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*            */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00001000000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Ref </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*                   */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00010000000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Snapshot </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*              */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00100000000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// Update &amp; Callback &amp; Ref &amp; Snapshot</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> LifecycleEffectMask </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*   */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00110100100</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// Union of all host effects</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> HostEffectMask </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*        */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b00111111111</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> Incomplete </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*            */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b01000000000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ShouldCapture </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">/*         */</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0b10000000000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="update-updatequeue" tabindex="-1">Update &amp; UpdateQueue <a class="header-anchor" href="#update-updatequeue" aria-hidden="true">#</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Update</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">State</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 更新的过期时间</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">expirationTime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ExpirationTime</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// export const UpdateState = 0;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// export const ReplaceState = 1;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// export const ForceUpdate = 2;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// export const CaptureUpdate = 3;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 指定更新的类型，值为以上几种</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">tag</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 更新内容，比如`setState`接收的第一个参数</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">payload</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 对应的回调，`setState`，`render`都有</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">callback</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">mixed</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 指向下一个更新</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">next</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Update</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">State</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 指向下一个`side effect`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nextEffect</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Update</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">State</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">UpdateQueue</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">State</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 每次操作完更新之后的`state`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">baseState</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">State</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 队列中的第一个`Update`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">firstUpdate</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Update</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">State</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 队列中的最后一个`Update`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">lastUpdate</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Update</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">State</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 第一个捕获类型的`Update`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">firstCapturedUpdate</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Update</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">State</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 最后一个捕获类型的`Update`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">lastCapturedUpdate</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Update</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">State</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 第一个`side effect`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">firstEffect</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Update</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">State</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 最后一个`side effect`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">lastEffect</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Update</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">State</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// 第一个和最后一个捕获产生的`side effect`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">firstCapturedEffect</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Update</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">State</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">lastCapturedEffect</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Update</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">State</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-bd22cb21 data-v-66ddf6b8><!----><div class="prev-next" data-v-66ddf6b8><div class="pager" data-v-66ddf6b8><a class="pager-link prev" href="/react/intro/3.html" data-v-66ddf6b8><span class="desc" data-v-66ddf6b8>Previous page</span><span class="title" data-v-66ddf6b8>React Children</span></a></div><div class="has-prev pager" data-v-66ddf6b8><a class="pager-link next" href="/react/update/1.html" data-v-66ddf6b8><span class="desc" data-v-66ddf6b8>Next page</span><span class="title" data-v-66ddf6b8>ReactDOM.render</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"readme.md\":\"f893b74b\",\"commit_1.md\":\"4d5cc155\",\"commit_2.md\":\"6abc44d4\",\"commit_3.md\":\"8c7b4e0f\",\"commit_4.md\":\"c47d0cb7\",\"commit_5.md\":\"4e8c4125\",\"commit_6.md\":\"19aa1f26\",\"commit_7.md\":\"1fd363af\",\"commit_8.md\":\"9e8d6a54\",\"func_1.md\":\"96509cba\",\"func_10.md\":\"fec205bb\",\"func_2.md\":\"56751759\",\"func_3.md\":\"d82c7c21\",\"func_4.md\":\"b8ed191d\",\"func_5.md\":\"a9866e09\",\"func_6.md\":\"2e511eaf\",\"func_7.md\":\"1cf5b14a\",\"func_8.md\":\"02cccd85\",\"func_9.md\":\"56ed4222\",\"hooks_1.md\":\"3684ab49\",\"hooks_2.md\":\"b4b2cad6\",\"hooks_3.md\":\"9d393f63\",\"hooks_4.md\":\"597d28b0\",\"hooks_5.md\":\"f30df68c\",\"index.md\":\"13fa6005\",\"intro_1.md\":\"84409033\",\"intro_2.md\":\"b1e9cdd3\",\"intro_3.md\":\"2d3e17e8\",\"intro_4.md\":\"7555dd74\",\"schedule_1.md\":\"03948e2c\",\"schedule_10.md\":\"51fa46e2\",\"schedule_11.md\":\"66f5b703\",\"schedule_12.md\":\"fd4f2277\",\"schedule_13.md\":\"620248fa\",\"schedule_14.md\":\"5381e8ba\",\"schedule_15.md\":\"d217a834\",\"schedule_16.md\":\"7033cfda\",\"schedule_17.md\":\"b9e9765f\",\"schedule_18.md\":\"e73bd215\",\"schedule_19.md\":\"8b5601c4\",\"schedule_2.md\":\"c4faa8e9\",\"schedule_20.md\":\"73bc2d3e\",\"schedule_21.md\":\"8745deab\",\"schedule_22.md\":\"85c7aca2\",\"schedule_23.md\":\"4ebd812b\",\"schedule_24.md\":\"6ffd2849\",\"schedule_25.md\":\"df5d9b81\",\"schedule_26.md\":\"9684421b\",\"schedule_3.md\":\"1cd44919\",\"schedule_4.md\":\"de615988\",\"schedule_5.md\":\"3d1db215\",\"schedule_6.md\":\"7cc52a24\",\"schedule_7.md\":\"e290431a\",\"schedule_8.md\":\"0c015178\",\"schedule_9.md\":\"9d62d961\",\"update_1.md\":\"69ac4b2b\",\"update_2.md\":\"c866a264\",\"update_3.md\":\"95efcfa1\"}")</script>
    <script type="module" async src="/react/assets/app.c44872b6.js"></script>
    
  </body>
</html>