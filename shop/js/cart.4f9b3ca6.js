(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["cart"],{"0516":function(e,t,c){"use strict";c("9f0f")},"0eaf":function(e,t,c){"use strict";var o=c("0324");const a=e=>(Object(o["pushScopeId"])("data-v-185b1a6a"),e=e(),Object(o["popScopeId"])(),e),n={class:"simple-header van-hairline--bottom"},l={key:1},r={class:"simple-header-name"},s=a(()=>Object(o["createElementVNode"])("i",{class:"nbicon nbmore"},null,-1)),d=a(()=>Object(o["createElementVNode"])("div",{class:"block"},null,-1));function b(e,t,c,a,b,i){return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createElementVNode"])("header",n,[a.isback?(Object(o["openBlock"])(),Object(o["createElementBlock"])("i",l,"      ")):(Object(o["openBlock"])(),Object(o["createElementBlock"])("i",{key:0,class:"nbicon nbfanhui",onClick:t[0]||(t[0]=(...e)=>a.goBack&&a.goBack(...e))})),Object(o["createElementVNode"])("div",r,Object(o["toDisplayString"])(c.name),1),s]),d],64)}c("f9ff");var i=c("7542"),u={props:{name:{type:String,default:""},back:{type:String,default:""},noback:{type:Boolean,default:!1}},emits:["callback"],setup(e,t){const c=Object(o["ref"])(e.noback),a=Object(i["d"])(),n=()=>{e.back?a.push({path:e.back}):a.go(-1),t.emit("callback")};return{goBack:n,isback:c}}},m=(c("90db"),c("9954")),O=c.n(m);const j=O()(u,[["render",b],["__scopeId","data-v-185b1a6a"]]);t["a"]=j},"1bbb":function(e,t,c){"use strict";c("73e4")},"44a9":function(e,t,c){},"73e4":function(e,t,c){},"90db":function(e,t,c){"use strict";c("44a9")},"9f0f":function(e,t,c){},b789:function(e,t,c){"use strict";c.r(t);var o=c("0324");const a={class:"cart-box"},n={class:"cart-body"},l={class:"good-item"},r={class:"good-img"},s=["src"],d={class:"good-desc"},b={class:"good-title"},i={class:"good-btn"},u={class:"price"},m={key:1,class:"empty"},O=Object(o["createElementVNode"])("img",{class:"empty-cart",src:"https://s.yezgea02.com/1604028375097/empty-car.png",alt:"空购物车"},null,-1),j=Object(o["createElementVNode"])("div",{class:"title"},"购物车空空如也",-1);function p(e,t,c,p,g,h){const k=Object(o["resolveComponent"])("s-header"),f=Object(o["resolveComponent"])("van-checkbox"),v=Object(o["resolveComponent"])("van-stepper"),C=Object(o["resolveComponent"])("van-button"),N=Object(o["resolveComponent"])("van-swipe-cell"),V=Object(o["resolveComponent"])("van-checkbox-group"),E=Object(o["resolveComponent"])("van-submit-bar"),y=Object(o["resolveComponent"])("nav-bar");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",a,[Object(o["createVNode"])(k,{name:"购物车",noback:!0}),Object(o["createElementVNode"])("div",n,[Object(o["createVNode"])(V,{onChange:p.groupChange,modelValue:e.result,"onUpdate:modelValue":t[0]||(t[0]=t=>e.result=t),ref:"checkboxGroup"},{default:Object(o["withCtx"])(()=>[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.list,(t,c)=>(Object(o["openBlock"])(),Object(o["createBlock"])(N,{"right-width":50,key:c},{right:Object(o["withCtx"])(()=>[Object(o["createVNode"])(C,{square:"",icon:"delete",type:"danger",class:"delete-button",onClick:e=>p.deleteGood(t.cartItemId)},null,8,["onClick"])]),default:Object(o["withCtx"])(()=>[Object(o["createElementVNode"])("div",l,[Object(o["createVNode"])(f,{name:t.cartItemId},null,8,["name"]),Object(o["createElementVNode"])("div",r,[Object(o["createElementVNode"])("img",{src:e.$filters.prefix(t.goodsCoverImg),alt:""},null,8,s)]),Object(o["createElementVNode"])("div",d,[Object(o["createElementVNode"])("div",b,[Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(t.goodsName),1),Object(o["createElementVNode"])("span",null,"x"+Object(o["toDisplayString"])(t.goodsCount),1)]),Object(o["createElementVNode"])("div",i,[Object(o["createElementVNode"])("div",u,"¥"+Object(o["toDisplayString"])(t.sellingPrice),1),Object(o["createVNode"])(v,{integer:"",min:1,max:5,"model-value":t.goodsCount,name:t.cartItemId,"async-change":"",onChange:p.onChange},null,8,["model-value","name","onChange"])])])])]),_:2},1024))),128))]),_:1},8,["onChange","modelValue"])]),e.list.length>0?(Object(o["openBlock"])(),Object(o["createBlock"])(E,{key:0,class:"submit-all van-hairline--top",price:100*p.total,"button-text":"结算",onSubmit:p.onSubmit},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(f,{onClick:p.allCheck,checked:e.checkAll,"onUpdate:checked":t[1]||(t[1]=t=>e.checkAll=t)},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("全选")]),_:1},8,["onClick","checked"])]),_:1},8,["price","onSubmit"])):Object(o["createCommentVNode"])("",!0),e.list.length?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",m,[O,j,Object(o["createVNode"])(C,{round:"",color:"#1baeae",type:"primary",onClick:p.goTo,block:""},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("前往选购")]),_:1},8,["onClick"])])),Object(o["createVNode"])(y)])}c("f106");var g=c("6e4c"),h=(c("f9ff"),c("7542")),k=c("de97"),f=c("d000"),v=c("0eaf"),C=c("8ee6"),N={components:{navBar:f["a"],sHeader:v["a"]},setup(){const e=Object(h["d"])(),t=Object(k["b"])(),c=Object(o["reactive"])({checked:!1,list:[],all:!1,result:[],checkAll:!0});Object(o["onMounted"])(()=>{a()});const a=async()=>{g["a"].loading({message:"加载中...",forbidClick:!0});const{data:e}=await Object(C["d"])({pageNumber:1});c.list=e,c.result=e.map(e=>e.cartItemId),g["a"].clear()},n=Object(o["computed"])(()=>{let e=0,t=c.list.filter(e=>c.result.includes(e.cartItemId));return t.forEach(t=>{e+=t.goodsCount*t.sellingPrice}),e}),l=()=>{e.go(-1)},r=()=>{e.push({path:"/home"})},s=async(e,t)=>{if(e>5)return void g["a"].fail("超出单个商品的最大购买数量");if(e<1)return void g["a"].fail("商品不得小于0");if(c.list.filter(e=>e.cartItemId==t.name)[0].goodsCount==e)return;g["a"].loading({message:"修改中...",forbidClick:!0});const o={cartItemId:t.name,goodsCount:e};await Object(C["e"])(o),c.list.forEach(c=>{c.cartItemId==t.name&&(c.goodsCount=e)}),g["a"].clear()},d=async()=>{if(0==c.result.length)return void g["a"].fail("请选择商品进行结算");const t=JSON.stringify(c.result);e.push({path:"/create-order",query:{cartItemIds:t}})},b=async e=>{await Object(C["b"])(e),t.dispatch("updateCart"),a()},i=e=>{console.log(1),e.length==c.list.length?(console.log(2),c.checkAll=!0):(console.log(3),c.checkAll=!1),c.result=e},u=()=>{c.checkAll?c.result=[]:c.result=c.list.map(e=>e.cartItemId)};return{...Object(o["toRefs"])(c),total:n,goBack:l,goTo:r,onChange:s,onSubmit:d,deleteGood:b,groupChange:i,allCheck:u}}},V=(c("1bbb"),c("9954")),E=c.n(V);const y=E()(N,[["render",p]]);t["default"]=y},d000:function(e,t,c){"use strict";var o=c("0324");const a=e=>(Object(o["pushScopeId"])("data-v-560cf072"),e=e(),Object(o["popScopeId"])(),e),n={class:"nav-bar van-hairline--top"},l={class:"nav-list"},r=a(()=>Object(o["createElementVNode"])("span",null,"首页",-1)),s=a(()=>Object(o["createElementVNode"])("span",null,"分类",-1)),d=a(()=>Object(o["createElementVNode"])("span",null,"购物车",-1)),b=a(()=>Object(o["createElementVNode"])("span",null,"我的",-1));function i(e,t,c,a,i,u){const m=Object(o["resolveComponent"])("van-icon"),O=Object(o["resolveComponent"])("router-link");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",n,[Object(o["createElementVNode"])("ul",l,[Object(o["createVNode"])(O,{class:"nav-list-item active",to:"home"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(m,{name:"wap-home-o"}),r]),_:1}),Object(o["createVNode"])(O,{class:"nav-list-item",to:"category"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(m,{name:"new-arrival-o"}),s]),_:1}),Object(o["createVNode"])(O,{class:"nav-list-item",to:"cart"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(m,{name:"shopping-cart-o",badge:a.count?a.count:""},null,8,["badge"]),d]),_:1}),Object(o["createVNode"])(O,{class:"nav-list-item",to:"user"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(m,{name:"contact"}),b]),_:1})])])}var u=c("7542"),m=c("de97"),O=c("495f"),j={setup(){const e=Object(u["c"])(),t=Object(m["b"])();Object(o["onMounted"])(()=>{const c=Object(O["a"])("token"),o=e.path;c&&!["/home","/category"].includes(o)&&t.dispatch("updateCart")});const c=Object(o["computed"])(()=>t.state.cartCount);return{count:c}}},p=(c("0516"),c("9954")),g=c.n(p);const h=g()(j,[["render",i],["__scopeId","data-v-560cf072"]]);t["a"]=h}}]);
//# sourceMappingURL=cart.4f9b3ca6.js.map