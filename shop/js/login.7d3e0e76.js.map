{"version":3,"sources":["webpack:///./src/views/Login.vue?1125","webpack:///./src/components/VueImageVerify.vue?92a1","webpack:///./src/views/Login.vue","webpack:///./src/components/VueImageVerify.vue","webpack:///./src/components/VueImageVerify.vue?66c5","webpack:///./src/views/Login.vue?ddb2"],"names":["class","_createElementVNode","src","alt","style","_createElementBlock","_hoisted_1","_createVNode","_component_s_header","name","_ctx","back","_hoisted_2","_hoisted_3","_component_van_form","onSubmit","$setup","_component_van_field","label","placeholder","rules","required","message","type","center","clearable","button","_component_vue_img_verify","ref","_hoisted_4","onClick","_component_van_button","round","block","color","native-type","_hoisted_5","_hoisted_6","width","height","setup","verify","state","reactive","pool","imgCode","onMounted","console","log","value","draw","handleDraw","randomNum","min","max","parseInt","Math","random","randomColor","r","g","b","ctx","getContext","fillStyle","fillRect","i","text","length","fontSize","deg","font","textBaseline","save","translate","rotate","PI","fillText","restore","beginPath","moveTo","lineTo","strokeStyle","closePath","stroke","arc","fill","toRefs","__exports__","verifyRef","username","password","username1","password1","toggle","v","async","toLowerCase","data","login","values","md5","setLocal","window","location","href","register","success","fail","components","sHeader","vueImgVerify","render"],"mappings":"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","file":"js/login.7d3e0e76.js","sourcesContent":["export * from \"-!../../node_modules/.pnpm/registry.npmmirror.com+mini-css-extract-plugin@0.9.0_webpack@4.46.0/node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/.pnpm/registry.npmmirror.com+css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/.pnpm/registry.npmmirror.com+vue-loader@16.8.3_b53wtzco7jeucllrao5nrweyei/node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/.pnpm/registry.npmmirror.com+postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/.pnpm/registry.npmmirror.com+less-loader@7.3.0_less@3.13.1/node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/.pnpm/registry.npmmirror.com+cache-loader@4.1.0_webpack@4.46.0/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/.pnpm/registry.npmmirror.com+vue-loader@16.8.3_b53wtzco7jeucllrao5nrweyei/node_modules/vue-loader/dist/index.js??ref--1-1!./Login.vue?vue&type=style&index=0&id=f4a8f742&lang=less\"","export * from \"-!../../node_modules/.pnpm/registry.npmmirror.com+mini-css-extract-plugin@0.9.0_webpack@4.46.0/node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/.pnpm/registry.npmmirror.com+css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/.pnpm/registry.npmmirror.com+vue-loader@16.8.3_b53wtzco7jeucllrao5nrweyei/node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/.pnpm/registry.npmmirror.com+postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/.pnpm/registry.npmmirror.com+cache-loader@4.1.0_webpack@4.46.0/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/.pnpm/registry.npmmirror.com+vue-loader@16.8.3_b53wtzco7jeucllrao5nrweyei/node_modules/vue-loader/dist/index.js??ref--1-1!./VueImageVerify.vue?vue&type=style&index=0&id=70df0acd&lang=css\"","\n<template>\n  <div class=\"login\">\n    <s-header :name=\"type == 'login' ? '登录' : '注册'\" :back=\"'/home'\"></s-header>\n    <img class=\"logo\" src=\"https://s.yezgea02.com/1604045825972/newbee-mall-vue3-app-logo.png\" alt=\"\">\n    <div v-if=\"type == 'login'\" class=\"login-body login\">\n      <van-form @submit=\"onSubmit\">\n        <van-field\n          v-model=\"username\"\n          name=\"username\"\n          label=\"用户名\"\n          placeholder=\"用户名\"\n          :rules=\"[{ required: true, message: '请填写用户名' }]\"\n        />\n        <van-field\n          v-model=\"password\"\n          type=\"password\"\n          name=\"password\"\n          label=\"密码\"\n          placeholder=\"密码\"\n          :rules=\"[{ required: true, message: '请填写密码' }]\"\n        />\n        <van-field\n          center\n          clearable\n          label=\"验证码\"\n          placeholder=\"输入验证码\"\n          v-model=\"verify\"\n        >\n          <template #button>\n            <vue-img-verify ref=\"verifyRef\" />\n          </template>\n        </van-field>\n        <div style=\"margin: 16px;\">\n          <div class=\"link-register\" @click=\"toggle('register')\">立即注册</div>\n          <van-button round block color=\"#1baeae\" native-type=\"submit\">登录</van-button>\n        </div>\n      </van-form>\n    </div>\n    <div v-else class=\"login-body register\">\n      <van-form @submit=\"onSubmit\">\n        <van-field\n          v-model=\"username1\"\n          name=\"username1\"\n          label=\"用户名\"\n          placeholder=\"用户名\"\n          :rules=\"[{ required: true, message: '请填写用户名' }]\"\n        />\n        <van-field\n          v-model=\"password1\"\n          type=\"password\"\n          name=\"password1\"\n          label=\"密码\"\n          placeholder=\"密码\"\n          :rules=\"[{ required: true, message: '请填写密码' }]\"\n        />\n        <van-field\n          center\n          clearable\n          label=\"验证码\"\n          placeholder=\"输入验证码\"\n          v-model=\"verify\"\n        >\n          <template #button>\n            <vue-img-verify ref=\"verifyRef\" />\n          </template>\n        </van-field>\n        <div style=\"margin: 16px;\">\n          <div class=\"link-login\" @click=\"toggle('login')\">已有登录账号</div>\n          <van-button round block color=\"#1baeae\" native-type=\"submit\">注册</van-button>\n        </div>\n      </van-form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { reactive, ref, toRefs } from 'vue'\nimport sHeader from '@/components/SimpleHeader'\nimport vueImgVerify from '@/components/VueImageVerify'\nimport { login, register } from '@/service/user'\nimport { setLocal } from '@/common/js/utils'\nimport md5 from 'js-md5'\nimport { Toast } from 'vant'\nexport default {\n  setup() {\n    const verifyRef = ref(null)\n    const state = reactive({\n      username: '',\n      password: '',\n      username1: '',\n      password1: '',\n      type: 'login',\n      imgCode: '',\n      verify: ''\n    })\n\n    // 切换登录和注册两种模式\n    const toggle = (v) => {\n      state.type = v\n      state.verify = ''\n    }\n\n    // 提交登录或注册表单\n    const onSubmit = async (values) => {\n      console.log('verifyRef.value.imgCode', verifyRef.value.imgCode)\n      state.imgCode = verifyRef.value.imgCode || ''\n      if (state.verify.toLowerCase() != state.imgCode.toLowerCase()) {\n        Toast.fail('验证码有误')\n        return\n      }\n      if (state.type == 'login') {\n        const { data } = await login({\n          \"loginName\": values.username,\n          \"passwordMd5\": md5(values.password)\n        })\n        setLocal('token', data)\n        // 需要刷新页面，否则 axios.js 文件里的 token 不会被重置\n        window.location.href = '/'\n      } else {\n        await register({\n          \"loginName\": values.username1,\n          \"password\": values.password1\n        })\n        Toast.success('注册成功')\n        state.type = 'login'\n        state.verify = ''\n      }\n    }\n\n    return {\n      ...toRefs(state),\n      toggle,\n      onSubmit,\n      verifyRef\n    }\n  },\n  components: {\n    sHeader,\n    vueImgVerify\n  }\n}\n</script>\n\n<style lang=\"less\">\n  .login {\n    .logo {\n      width: 120px;\n      height: 120px;\n      display: block;\n      margin: 80px auto 20px;\n    }\n    .login-body {\n      padding: 0 20px;\n    }\n    .login {\n      .link-register {\n        font-size: 14px;\n        margin-bottom: 20px;\n        color: #1989fa;\n        display: inline-block;\n      }\n    }\n    .register {\n      .link-login {\n        font-size: 14px;\n        margin-bottom: 20px;\n        color: #1989fa;\n        display: inline-block;\n      }\n    }\n    .verify-bar-area {\n      margin-top: 24px;\n      .verify-left-bar {\n        border-color: #1baeae;\n      }\n      .verify-move-block {\n        background-color: #1baeae;\n        color: #fff;\n      }\n    }\n    .verify {\n      >div {\n        width: 100%;\n      }\n      display: flex;\n      justify-content: center;\n      .cerify-code-panel {\n        margin-top: 16px;\n      }\n      .verify-code {\n        width: 40%!important;\n        float: left!important;\n      }\n      .verify-code-area {\n        float: left!important;\n        width: 54%!important;\n        margin-left: 14px!important;\n        .varify-input-code {\n          width: 90px;\n          height: 38px!important;\n          border: 1px solid #e9e9e9;\n          padding-left: 10px;\n          font-size: 16px;\n        }\n        .verify-change-area {\n          line-height: 44px;\n        }\n      }\n    }\n  }\n</style>\n","<template>\n  <div class=\"img-verify\">\n    <canvas ref=\"verify\" :width=\"width\" :height=\"height\" @click=\"handleDraw\"></canvas>\n  </div>\n</template>\n\n<script>\nimport { reactive, onMounted, ref, toRefs } from 'vue'\nexport default {\n  setup() {\n    const verify = ref(null)\n    const state = reactive({\n      pool: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890', // 字符串\n      width: 120,\n      height: 40,\n      imgCode: ''\n    })\n    onMounted(() => {\n      // 初始化绘制图片验证码\n      console.log(verify.value)\n      state.imgCode = draw()\n    })\n    \n    // 点击图片重新绘制\n    const handleDraw = () => {\n      state.imgCode = draw()\n    }\n\n    // 随机数\n    const randomNum = (min, max) => {\n      return parseInt(Math.random() * (max - min) + min)\n    }\n    // 随机颜色\n    const randomColor = (min, max) => {\n      const r = randomNum(min, max)\n      const g = randomNum(min, max)\n      const b = randomNum(min, max)\n      return `rgb(${r},${g},${b})`\n    }\n\n    // 绘制图片\n    const draw = () => {\n      // 3.填充背景颜色，背景颜色要浅一点\n      const ctx = verify.value.getContext('2d')\n      // 填充颜色\n      ctx.fillStyle = randomColor(180, 230)\n      // 填充的位置\n      ctx.fillRect(0, 0, state.width, state.height)\n      // 定义paramText\n      let imgCode = ''\n      // 4.随机产生字符串，并且随机旋转\n      for (let i = 0; i < 4; i++) {\n        // 随机的四个字\n        const text = state.pool[randomNum(0, state.pool.length)]\n        imgCode += text\n        // 随机的字体大小\n        const fontSize = randomNum(18, 40)\n        // 字体随机的旋转角度\n        const deg = randomNum(-30, 30)\n        /*\n         * 绘制文字并让四个文字在不同的位置显示的思路 :\n         * 1、定义字体\n         * 2、定义对齐方式\n         * 3、填充不同的颜色\n         * 4、保存当前的状态（以防止以上的状态受影响）\n         * 5、平移translate()\n         * 6、旋转 rotate()\n         * 7、填充文字\n         * 8、restore出栈\n         * */\n        ctx.font = fontSize + 'px Simhei'\n        ctx.textBaseline = 'top'\n        ctx.fillStyle = randomColor(80, 150)\n        /*\n         * save() 方法把当前状态的一份拷贝压入到一个保存图像状态的栈中。\n         * 这就允许您临时地改变图像状态，\n         * 然后，通过调用 restore() 来恢复以前的值。\n         * save是入栈，restore是出栈。\n         * 用来保存Canvas的状态。save之后，可以调用Canvas的平移、放缩、旋转、错切、裁剪等操作。 restore：用来恢复Canvas之前保存的状态。防止save后对Canvas执行的操作对后续的绘制有影响。\n         *\n         * */\n        ctx.save()\n        ctx.translate(30 * i + 15, 15)\n        ctx.rotate((deg * Math.PI) / 180)\n        // fillText() 方法在画布上绘制填色的文本。文本的默认颜色是黑色。\n        // 请使用 font 属性来定义字体和字号，并使用 fillStyle 属性以另一种颜色/渐变来渲染文本。\n        // context.fillText(text,x,y,maxWidth);\n        ctx.fillText(text, -15 + 5, -15)\n        ctx.restore()\n      }\n      // 5.随机产生5条干扰线,干扰线的颜色要浅一点\n      for (let i = 0; i < 5; i++) {\n        ctx.beginPath()\n        ctx.moveTo(randomNum(0, state.width), randomNum(0, state.height))\n        ctx.lineTo(randomNum(0, state.width), randomNum(0, state.height))\n        ctx.strokeStyle = randomColor(180, 230)\n        ctx.closePath()\n        ctx.stroke()\n      }\n      // 6.随机产生40个干扰的小点\n      for (let i = 0; i < 40; i++) {\n        ctx.beginPath()\n        ctx.arc(randomNum(0, state.width), randomNum(0, state.height), 1, 0, 2 * Math.PI)\n        ctx.closePath()\n        ctx.fillStyle = randomColor(150, 220)\n        ctx.fill()\n      }\n      return imgCode\n    }\n\n    return {\n      ...toRefs(state),\n      verify,\n      handleDraw\n    }\n  }\n}\n</script>\n<style type=\"text/css\">\n.img-verify canvas {\n  cursor: pointer;\n}\n</style>","import { render } from \"./VueImageVerify.vue?vue&type=template&id=70df0acd\"\nimport script from \"./VueImageVerify.vue?vue&type=script&lang=js\"\nexport * from \"./VueImageVerify.vue?vue&type=script&lang=js\"\n\nimport \"./VueImageVerify.vue?vue&type=style&index=0&id=70df0acd&lang=css\"\n\nimport exportComponent from \"/Users/aigouzz/fe-project/vue3-vant-app/node_modules/.pnpm/registry.npmmirror.com+vue-loader@16.8.3_b53wtzco7jeucllrao5nrweyei/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./Login.vue?vue&type=template&id=f4a8f742\"\nimport script from \"./Login.vue?vue&type=script&lang=js\"\nexport * from \"./Login.vue?vue&type=script&lang=js\"\n\nimport \"./Login.vue?vue&type=style&index=0&id=f4a8f742&lang=less\"\n\nimport exportComponent from \"/Users/aigouzz/fe-project/vue3-vant-app/node_modules/.pnpm/registry.npmmirror.com+vue-loader@16.8.3_b53wtzco7jeucllrao5nrweyei/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}