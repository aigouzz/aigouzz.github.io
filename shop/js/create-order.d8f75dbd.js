(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["create-order"],{"0eaf":function(e,t,c){"use strict";var a=c("0324");const r=e=>(Object(a["pushScopeId"])("data-v-185b1a6a"),e=e(),Object(a["popScopeId"])(),e),o={class:"simple-header van-hairline--bottom"},n={key:1},s={class:"simple-header-name"},d=r(()=>Object(a["createElementVNode"])("i",{class:"nbicon nbmore"},null,-1)),l=r(()=>Object(a["createElementVNode"])("div",{class:"block"},null,-1));function i(e,t,c,r,i,b){return Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],null,[Object(a["createElementVNode"])("header",o,[r.isback?(Object(a["openBlock"])(),Object(a["createElementBlock"])("i",n,"      ")):(Object(a["openBlock"])(),Object(a["createElementBlock"])("i",{key:0,class:"nbicon nbfanhui",onClick:t[0]||(t[0]=(...e)=>r.goBack&&r.goBack(...e))})),Object(a["createElementVNode"])("div",s,Object(a["toDisplayString"])(c.name),1),d]),l],64)}c("f9ff");var b=c("7542"),u={props:{name:{type:String,default:""},back:{type:String,default:""},noback:{type:Boolean,default:!1}},emits:["callback"],setup(e,t){const c=Object(a["ref"])(e.noback),r=Object(b["d"])(),o=()=>{e.back?r.push({path:e.back}):r.go(-1),t.emit("callback")};return{goBack:o,isback:c}}},p=(c("90db"),c("9954")),O=c.n(p);const j=O()(u,[["render",i],["__scopeId","data-v-185b1a6a"]]);t["a"]=j},"3f49":function(e,t,c){"use strict";c.d(t,"c",(function(){return r})),c.d(t,"b",(function(){return o})),c.d(t,"a",(function(){return n})),c.d(t,"f",(function(){return s})),c.d(t,"e",(function(){return d})),c.d(t,"d",(function(){return l}));var a=c("a27e");function r(e){return a["a"].post("/address",e)}function o(e){return a["a"].put("/address",e)}function n(e){return a["a"].delete("/address/"+e)}function s(){return a["a"].get("/address/default")}function d(){return a["a"].get("/address",{pageNumber:1,pageSize:1e3})}function l(e){return a["a"].get("/address/"+e)}},"44a9":function(e,t,c){},"49d6":function(e,t,c){"use strict";c("cdaf")},"4fa1":function(e,t,c){"use strict";c.r(t);var a=c("0324");const r=e=>(Object(a["pushScopeId"])("data-v-85c7a252"),e=e(),Object(a["popScopeId"])(),e),o={class:"create-order"},n={class:"address-wrap"},s={class:"address"},d={class:"good"},l={class:"good-img"},i=["src"],b={class:"good-desc"},u={class:"good-title"},p={class:"good-btn"},O={class:"price"},j={class:"pay-wrap"},m={class:"price"},f=r(()=>Object(a["createElementVNode"])("span",null,"商品金额",-1)),g={style:{width:"90%",margin:"0 auto",padding:"50px 0"}};function N(e,t,c,r,N,k){const y=Object(a["resolveComponent"])("s-header"),h=Object(a["resolveComponent"])("van-icon"),v=Object(a["resolveComponent"])("van-button"),I=Object(a["resolveComponent"])("van-popup");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",o,[Object(a["createVNode"])(y,{name:"生成订单",onCallback:r.deleteLocal},null,8,["onCallback"]),Object(a["createElementVNode"])("div",n,[Object(a["createElementVNode"])("div",{class:"name",onClick:t[0]||(t[0]=(...e)=>r.goTo&&r.goTo(...e))},[Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(e.address.userName),1),Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(e.address.userPhone),1)]),Object(a["createElementVNode"])("div",s,Object(a["toDisplayString"])(e.address.provinceName)+" "+Object(a["toDisplayString"])(e.address.cityName)+" "+Object(a["toDisplayString"])(e.address.regionName)+" "+Object(a["toDisplayString"])(e.address.detailAddress),1),Object(a["createVNode"])(h,{class:"arrow",name:"arrow"})]),Object(a["createElementVNode"])("div",d,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.cartList,(t,c)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:"good-item",key:c},[Object(a["createElementVNode"])("div",l,[Object(a["createElementVNode"])("img",{src:e.$filters.prefix(t.goodsCoverImg),alt:""},null,8,i)]),Object(a["createElementVNode"])("div",b,[Object(a["createElementVNode"])("div",u,[Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(t.goodsName),1),Object(a["createElementVNode"])("span",null,"x"+Object(a["toDisplayString"])(t.goodsCount),1)]),Object(a["createElementVNode"])("div",p,[Object(a["createElementVNode"])("div",O,"¥"+Object(a["toDisplayString"])(t.sellingPrice),1)])])]))),128))]),Object(a["createElementVNode"])("div",j,[Object(a["createElementVNode"])("div",m,[f,Object(a["createElementVNode"])("span",null,"¥"+Object(a["toDisplayString"])(r.total),1)]),Object(a["createVNode"])(v,{onClick:r.handleCreateOrder,class:"pay-btn",color:"#1baeae",type:"primary",block:""},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("生成订单")]),_:1},8,["onClick"])]),Object(a["createVNode"])(I,{closeable:"","close-on-click-overlay":!1,show:e.showPay,"onUpdate:show":t[3]||(t[3]=t=>e.showPay=t),position:"bottom",style:{height:"30%"},onClose:r.close},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",g,[Object(a["createVNode"])(v,{style:{marginBottom:"10px"},color:"#1989fa",block:"",onClick:t[1]||(t[1]=e=>r.handlePayOrder(1))},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("支付宝支付")]),_:1}),Object(a["createVNode"])(v,{color:"#4fc08d",block:"",onClick:t[2]||(t[2]=e=>r.handlePayOrder(2))},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("微信支付")]),_:1})])]),_:1},8,["show","onClose"])])}c("f106");var k=c("6e4c"),y=(c("f9ff"),c("0eaf")),h=c("8ee6"),v=c("3f49"),I=c("99c5"),V=c("495f"),E=c("7542"),w={components:{sHeader:y["a"]},setup(){const e=Object(E["d"])(),t=Object(E["c"])(),c=Object(a["reactive"])({cartList:[],address:{},showPay:!1,orderNo:"",cartItemIds:[]});Object(a["onMounted"])(()=>{r()});const r=async()=>{k["a"].loading({message:"加载中...",forbidClick:!0});const{addressId:a,cartItemIds:r}=t.query,o=r?JSON.parse(r):JSON.parse(Object(V["a"])("cartItemIds"));console.log("cartItemIds",r),Object(V["c"])("cartItemIds",JSON.stringify(o));const{data:n}=await Object(h["c"])({cartItemIds:o.join(",")}),{data:s}=a?await Object(v["d"])(a):await Object(v["f"])();s?(c.cartList=n,c.address=s,k["a"].clear()):e.push({path:"/address"})},o=()=>{e.push({path:"/address",query:{cartItemIds:JSON.stringify(c.cartItemIds),from:"create-order"}})},n=()=>{Object(V["c"])("cartItemIds","")},s=async()=>{const e={addressId:c.address.addressId,cartItemIds:c.cartList.map(e=>e.cartItemId)},{data:t}=await Object(I["c"])(e);Object(V["c"])("cartItemIds",""),c.orderNo=t,c.showPay=!0},d=()=>{e.push({path:"/order"})},l=async t=>{await Object(I["f"])({orderNo:c.orderNo,payType:t}),k["a"].success("支付成功"),setTimeout(()=>{e.push({path:"/order"})},2e3)},i=Object(a["computed"])(()=>{let e=0;return c.cartList.forEach(t=>{e+=t.goodsCount*t.sellingPrice}),e});return{...Object(a["toRefs"])(c),goTo:o,deleteLocal:n,handleCreateOrder:s,close:d,handlePayOrder:l,total:i}}},C=(c("49d6"),c("9954")),S=c.n(C);const B=S()(w,[["render",N],["__scopeId","data-v-85c7a252"]]);t["default"]=B},"90db":function(e,t,c){"use strict";c("44a9")},"99c5":function(e,t,c){"use strict";c.d(t,"c",(function(){return r})),c.d(t,"e",(function(){return o})),c.d(t,"d",(function(){return n})),c.d(t,"a",(function(){return s})),c.d(t,"b",(function(){return d})),c.d(t,"f",(function(){return l}));var a=c("a27e");function r(e){return a["a"].post("/saveOrder",e)}function o(e){return a["a"].get("/order",{params:e})}function n(e){return a["a"].get("/order/"+e)}function s(e){return a["a"].put(`/order/${e}/cancel`)}function d(e){return a["a"].put(`/order/${e}/finish`)}function l(e){return a["a"].get("/paySuccess",{params:e})}},cdaf:function(e,t,c){}}]);
//# sourceMappingURL=create-order.d8f75dbd.js.map