"use strict";(self["webpackChunkvue3_init_music"]=self["webpackChunkvue3_init_music"]||[]).push([[431],{6431:function(t,e,i){i.r(e),i.d(e,{default:function(){return E}});var r=i(3396),a=i(7139);const l=t=>((0,r.dD)("data-v-fa20568c"),t=t(),(0,r.Cn)(),t),s={class:"content"},c={class:"player-wrapper"},n={class:"player-inner"},o={class:"play-title"},d={class:"play-name"},u={class:"play-singer"},m=l((()=>(0,r._)("div",{class:"bar-line"},null,-1))),p={order:"0"},h=l((()=>(0,r._)("div",{class:"stick"},null,-1))),v=l((()=>(0,r._)("div",{class:"cd-mask"},null,-1))),f=["src"],g={order:"2",class:"bottom-wrapper"},y={class:"lyric-holder"},_=["id"],b={class:"process-bar"},k={class:"pro"},C={class:"pro-wrap"},w={class:"time"},L={id:"cur"},x={id:"total"},T={class:"control-bar"},W={class:"mask"},I=l((()=>(0,r._)("div",{class:"cover-mask",style:{opacity:"0.6"}},null,-1)));function $(t,e,i,l,$,P){const S=(0,r.up)("van-icon"),B=(0,r.up)("van-nav-bar"),z=(0,r.up)("mu-slider"),D=(0,r.up)("van-button"),N=(0,r.up)("van-space"),E=(0,r.up)("BottomSheet");return(0,r.wg)(),(0,r.iD)("div",s,[(0,r._)("div",c,[(0,r._)("div",n,[(0,r.Wm)(B,null,{left:(0,r.w5)((()=>[(0,r.Wm)(S,{name:"arrow-left",onClick:P.back},null,8,["onClick"])])),title:(0,r.w5)((()=>[(0,r._)("div",o,[(0,r._)("div",d,[(0,r._)("span",null,(0,a.zw)(t.audio.name),1)]),(0,r._)("div",u,(0,a.zw)(t.audio.singer),1)])])),right:(0,r.w5)((()=>[(0,r.Wm)(S,{name:"share",onClick:t.share},null,8,["onClick"])])),_:1}),m,(0,r.Wm)(N,{direction:"vertical",fill:"",class:"main"},{default:(0,r.w5)((()=>[(0,r._)("div",p,[(0,r._)("div",{class:(0,a.C_)(["cd-holder",{"cd-play":t.playing}])},[h,(0,r._)("div",{class:(0,a.C_)(["cd-wrapper",{"cd-rotate":t.playing}])},[v,(0,r._)("img",{class:"cd-img",src:t.audio.albumPic+"?param=500y500"},null,8,f)],2)],2)]),(0,r._)("div",g,[(0,r._)("div",y,[(0,r._)("div",{class:"lrc-inner",style:(0,a.j5)([{transition:"-webkit-transform 0.3s ease-out","transform-origin":"0px 0px 0px"},{transform:" translate3d(0px,"+P.lrcOffset+"px, 0px)"}])},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)($.afterLrc,((t,e)=>((0,r.wg)(),(0,r.iD)("p",{id:"line-"+e,key:e},(0,a.zw)(t.txt),9,_)))),128))],4)]),(0,r._)("div",b,[(0,r._)("div",k,[(0,r._)("div",C,[(0,r.Wm)(z,{class:"song-slider",onChange:P.changeTime,modelValue:P.prCurrentTime,"onUpdate:modelValue":e[0]||(e[0]=t=>P.prCurrentTime=t)},null,8,["onChange","modelValue"])]),(0,r._)("div",w,[(0,r._)("time",L,(0,a.zw)(P.setTime(t.currentTime)),1),(0,r._)("time",x,(0,a.zw)(P.setTime(t.durationTime)),1)])])]),(0,r._)("div",T,[(0,r.Wm)(D,{class:"btn d-mode"}),(0,r.Wm)(D,{class:"btn d-prev",onClick:t.playPrev},null,8,["onClick"]),(0,r.Wm)(D,{class:(0,a.C_)(["btn d-play btn-big",{"d-pause":t.playing}]),onClick:P.togglePlay},null,8,["onClick","class"]),(0,r.Wm)(D,{class:"btn d-next",onClick:t.playNext},null,8,["onClick"]),(0,r.Wm)(D,{class:"btn d-list",onClick:P.showList},null,8,["onClick"])])])])),_:1})])]),(0,r._)("div",W,[(0,r._)("div",{class:"album-cover",style:(0,a.j5)({"background-image":"url("+t.audio.albumPic+"?param=500y500)"})},null,4),I]),(0,r.Wm)(E,{ref:"bottomSheet"},null,512)])}i(7658);var P=i(65),S=i(4357),B=i(3744),z={data(){return{lyric:"",afterLrc:[],lrcIndex:0}},components:{BottomSheet:S.Z},beforeRouteEnter:(t,e,i)=>{i((e=>{parseInt(t.params.id)===parseInt(e.audio.id)&&""!==e.lyric||e.loadLrc(e.audio.id),e.$store.commit("setBar",!1)}))},beforeRouteLeave(t,e,i){this.$store.commit("setBar",!0),i()},watch:{audio(t){this.loadLrc(t.id)}},methods:{setTime(t){var e=Math.floor(parseInt(t)),i=Math.floor(t/60);i<10&&(i="0"+i);var r=e%60;return r<10&&(r="0"+r),i+":"+r},togglePlay(){this.playing?(this.$store.commit("pause"),document.getElementById("audioPlay").pause()):(this.$store.commit("play"),document.getElementById("audioPlay").play())},back(){this.$router.go(-1),this.$store.commit("toggleDetail")},changeTime(t){var e=t*this.durationTime/100;this.$store.commit("changeTime",e),this.$store.commit("setChange",!0)},loadLrc(t){this.afterLrc=[{txt:"正在加载中..."}],t?B.Z.getLrc(t).then((t=>{t.lrc.lyric?(this.lyric=t.lrc.lyric,this.getLrc()):this.afterLrc=[{txt:"(⊙０⊙) 暂无歌词"}]}),(t=>{console.log("lrc fail"),this.afterLrc=[{txt:"加载歌词失败"}]})).catch((function(t){console.log(t),this.afterLrc=[{txt:"(⊙０⊙) 暂无歌词"}]})):this.afterLrc=[{txt:"这里显示歌词哦！"}]},getLrc(){if(this.lyric){for(var t=this.lyric.split("\n"),e=[],i=/\[\d*:\d*((\.|\:)\d*)*\]/g,r=0;r<t.length;r++){var a=t[r].match(i);if(a)for(var l=t[r].replace(i,""),s=0;s<a.length;s++){var c={},n=a[s],o=Number(String(n.match(/\[\d*/i)).slice(1)),d=Number(String(n.match(/\:\d*/i)).slice(1)),u=60*o+d;c.time=u,c.txt=l,e.push(c)}}this.afterLrc=e}},showList(){this.$refs.bottomSheet.show()},...(0,P.OI)(["playNext","playPrev"])},computed:{...(0,P.Se)(["currentTime","bufferedTime","durationTime","audio","playing"]),prCurrentTime:{get:function(){return this.$store.getters.prCurrentTime},set:function(t){}},lrcOffset(){if(this.afterLrc){let t=Math.round(this.currentTime);for(let e=0;e<this.afterLrc.length;e++)this.afterLrc[e].time===t&&(this.lrcIndex=e);return 58*-this.lrcIndex}return!1}}},D=i(89);const N=(0,D.Z)(z,[["render",$],["__scopeId","data-v-fa20568c"]]);var E=N}}]);
//# sourceMappingURL=431.cb9b0b59.js.map