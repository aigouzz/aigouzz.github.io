"use strict";(self["webpackChunkvue3_init_music"]=self["webpackChunkvue3_init_music"]||[]).push([[443],{7443:function(t,e,i){i.r(e),i.d(e,{default:function(){return N}});var r=i(3396),a=i(7139);const l=t=>((0,r.dD)("data-v-35f4824c"),t=t(),(0,r.Cn)(),t),s={class:"content"},c={class:"player-wrapper"},n={class:"player-inner"},o={class:"play-title"},d={class:"play-name"},m=l((()=>(0,r._)("div",{class:"bar-line"},null,-1))),u={order:"0"},p=l((()=>(0,r._)("div",{class:"stick"},null,-1))),h=l((()=>(0,r._)("div",{class:"cd-mask"},null,-1))),v=["src"],f={order:"2",class:"bottom-wrapper"},g={class:"lyric-holder"},y=["id"],_={class:"process-bar"},b={class:"pro"},k={class:"pro-wrap"},C={class:"time"},w={id:"cur"},L={id:"total"},x={class:"control-bar"},T={class:"mask"},W=l((()=>(0,r._)("div",{class:"cover-mask",style:{opacity:"0.6"}},null,-1)));function I(t,e,i,l,I,$){const P=(0,r.up)("van-icon"),S=(0,r.up)("van-nav-bar"),z=(0,r.up)("van-slider"),B=(0,r.up)("van-button"),D=(0,r.up)("van-space"),N=(0,r.up)("BottomSheet");return(0,r.wg)(),(0,r.iD)("div",s,[(0,r._)("div",c,[(0,r._)("div",n,[(0,r.Wm)(S,null,{left:(0,r.w5)((()=>[(0,r.Wm)(P,{name:"arrow-left",size:".6rem",onClick:$.back},null,8,["onClick"])])),title:(0,r.w5)((()=>[(0,r._)("div",o,[(0,r._)("div",d,[(0,r._)("span",null,(0,a.zw)(t.audio.name)+"-"+(0,a.zw)(t.audio.singer),1)])])])),right:(0,r.w5)((()=>[(0,r.Wm)(P,{name:"share",onClick:t.share},null,8,["onClick"])])),_:1}),m,(0,r.Wm)(D,{direction:"vertical",fill:"",class:"main"},{default:(0,r.w5)((()=>[(0,r._)("div",u,[(0,r._)("div",{class:(0,a.C_)(["cd-holder",{"cd-play":t.playing}])},[p,(0,r._)("div",{class:(0,a.C_)(["cd-wrapper",{"cd-rotate":t.playing}])},[h,(0,r._)("img",{class:"cd-img",src:t.audio.albumPic+"?param=500y500"},null,8,v)],2)],2)]),(0,r._)("div",f,[(0,r._)("div",g,[(0,r._)("div",{class:"lrc-inner",style:(0,a.j5)([{transition:"-webkit-transform 0.3s ease-out","transform-origin":"0px 0px 0px"},{transform:" translate3d(0px,"+$.lrcOffset+"px, 0px)"}])},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(I.afterLrc,((t,e)=>((0,r.wg)(),(0,r.iD)("p",{id:"line-"+e,key:e},(0,a.zw)(t.txt),9,y)))),128))],4)]),(0,r._)("div",_,[(0,r._)("div",b,[(0,r._)("div",k,[(0,r.Wm)(z,{class:"song-slider",onChange:$.changeTime,modelValue:$.prCurrentTime,"onUpdate:modelValue":e[0]||(e[0]=t=>$.prCurrentTime=t)},null,8,["onChange","modelValue"])]),(0,r._)("div",C,[(0,r._)("time",w,(0,a.zw)($.setTime(t.currentTime)),1),(0,r._)("time",L,(0,a.zw)($.setTime(t.durationTime)),1)])])]),(0,r._)("div",x,[(0,r.Wm)(B,{class:"btn d-mode"}),(0,r.Wm)(B,{class:"btn d-prev",onClick:t.playPrev},null,8,["onClick"]),(0,r.Wm)(B,{class:(0,a.C_)(["btn d-play btn-big",{"d-pause":t.playing}]),onClick:$.togglePlay},null,8,["onClick","class"]),(0,r.Wm)(B,{class:"btn d-next",onClick:t.playNext},null,8,["onClick"]),(0,r.Wm)(B,{class:"btn d-list",onClick:$.showList},null,8,["onClick"])])])])),_:1})])]),(0,r._)("div",T,[(0,r._)("div",{class:"album-cover",style:(0,a.j5)({"background-image":"url("+t.audio.albumPic+"?param=500y500)"})},null,4),W]),(0,r.Wm)(N,{ref:"bottomSheet"},null,512)])}i(7658);var $=i(65),P=i(4357),S=i(3744),z={data(){return{lyric:"",afterLrc:[],lrcIndex:0}},components:{BottomSheet:P.Z},beforeRouteEnter:(t,e,i)=>{i((e=>{parseInt(t.params.id)===parseInt(e.audio.id)&&""!==e.lyric||e.loadLrc(e.audio.id),e.$store.commit("setBar",!1)}))},beforeRouteLeave(t,e,i){this.$store.commit("setBar",!0),i()},watch:{audio(t){this.loadLrc(t.id)}},methods:{setTime(t){var e=Math.floor(parseInt(t)),i=Math.floor(t/60);i<10&&(i="0"+i);var r=e%60;return r<10&&(r="0"+r),i+":"+r},togglePlay(){this.playing?(this.$store.commit("pause"),document.getElementById("audioPlay").pause()):(this.$store.commit("play"),document.getElementById("audioPlay").play())},back(){this.$router.go(-1),this.$store.commit("toggleDetail")},changeTime(t){var e=t*this.durationTime/100;this.$store.commit("changeTime",e),this.$store.commit("setChange",!0)},loadLrc(t){this.afterLrc=[{txt:"正在加载中..."}],t?S.Z.getLrc(t).then((t=>{t.lrc.lyric?(this.lyric=t.lrc.lyric,this.getLrc()):this.afterLrc=[{txt:"(⊙０⊙) 暂无歌词"}]}),(t=>{console.log("lrc fail"),this.afterLrc=[{txt:"加载歌词失败"}]})).catch((function(t){console.log(t),this.afterLrc=[{txt:"(⊙０⊙) 暂无歌词"}]})):this.afterLrc=[{txt:"这里显示歌词哦！"}]},getLrc(){if(this.lyric){for(var t=this.lyric.split("\n"),e=[],i=/\[\d*:\d*((\.|\:)\d*)*\]/g,r=0;r<t.length;r++){var a=t[r].match(i);if(a)for(var l=t[r].replace(i,""),s=0;s<a.length;s++){var c={},n=a[s],o=Number(String(n.match(/\[\d*/i)).slice(1)),d=Number(String(n.match(/\:\d*/i)).slice(1)),m=60*o+d;c.time=m,c.txt=l,e.push(c)}}this.afterLrc=e}},showList(){this.$refs.bottomSheet.show()},...(0,$.OI)(["playNext","playPrev"])},computed:{...(0,$.Se)(["currentTime","bufferedTime","durationTime","audio","playing"]),prCurrentTime:{get:function(){return this.$store.getters.prCurrentTime},set:function(t){}},lrcOffset(){if(this.afterLrc){let t=Math.round(this.currentTime);for(let e=0;e<this.afterLrc.length;e++)this.afterLrc[e].time===t&&(this.lrcIndex=e);return 58*-this.lrcIndex}return!1}}},B=i(89);const D=(0,B.Z)(z,[["render",I],["__scopeId","data-v-35f4824c"]]);var N=D}}]);
//# sourceMappingURL=443.15d70df0.js.map