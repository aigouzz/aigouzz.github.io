"use strict";(self["webpackChunkvue3_init_pc_shop"]=self["webpackChunkvue3_init_pc_shop"]||[]).push([[722],{1923:function(s,t,e){e.d(t,{Z:function(){return b}});var i=e(4317),d=e(5964);const a=s=>((0,i.dD)("data-v-069b65c0"),s=s(),(0,i.Cn)(),s),l={key:0,class:"popup"},r={class:"mask"},n={class:"content"},u={class:"topbar"},c={class:"dialog-tit"},o={t:"1501234940517",class:"icon",style:{},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3014","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"20",height:"20"},p=a((()=>(0,i._)("path",{d:"M941.576 184.248l-101.824-101.824L512 410.176 184.248 82.424 82.424 184.248 410.168 512l-327.744 327.752 101.824 101.824L512 613.824l327.752 327.752 101.824-101.824L613.832 512z",fill:"#cdcdcd","p-id":"3015"},null,-1))),m=[p],h={class:"s-content"};function g(s,t,e,a,p,g){return e.open?((0,i.wg)(),(0,i.iD)("div",l,[(0,i._)("div",r,[(0,i._)("div",n,[(0,i._)("div",u,[(0,i._)("div",c,[(0,i._)("h4",null,(0,d.zw)(e.title),1)]),(0,i._)("span",{class:"close",onClick:t[0]||(t[0]=(...s)=>g.close&&g.close(...s))},[((0,i.wg)(),(0,i.iD)("svg",o,m))])]),(0,i._)("div",h,[(0,i.WI)(s.$slots,"content",{},void 0,!0)])])])])):(0,i.kq)("",!0)}var _={props:{open:{type:Boolean,default:!1},title:{type:String,default:"管理收货地址"}},methods:{close(){this.$emit("close")}}},v=e(963);const f=(0,v.Z)(_,[["render",g],["__scopeId","data-v-069b65c0"]]);var b=f},4154:function(s,t,e){e.d(t,{Z:function(){return o}});var i=e(4317),d=e(5964);const a={class:"gray-box"},l={class:"title"};function r(s,t,e,r,n,u){return(0,i.wg)(),(0,i.iD)("div",a,[(0,i._)("div",l,[(0,i._)("h2",null,(0,d.zw)(e.title),1),(0,i._)("div",null,[(0,i.WI)(s.$slots,"right",{},void 0,!0)])]),(0,i._)("div",null,[(0,i.WI)(s.$slots,"content",{},void 0,!0)])])}var n={props:["title"]},u=e(963);const c=(0,u.Z)(n,[["render",r],["__scopeId","data-v-6099d476"]]);var o=c},6059:function(s,t,e){e.r(t),e.d(t,{default:function(){return es}});var i=e(4317),d=e(5964),a=e(9333),l=e.p+"img/jia.a48b7c65.svg";const r=s=>((0,i.dD)("data-v-1d0fb24c"),s=s(),(0,i.Cn)(),s),n={class:"checkout"},u={class:"w",style:{"padding-top":"40px"}},c={class:"address-item-list clearfix"},o=["onClick"],p={key:0,class:"pa"},m=r((()=>(0,i._)("svg",{viewBox:"0 0 1473 1024",width:"17.34375",height:"12"},[(0,i._)("path",{d:"M1388.020 57.589c-15.543-15.787-37.146-25.569-61.033-25.569s-45.491 9.782-61.023 25.558l-716.054 723.618-370.578-374.571c-15.551-15.769-37.151-25.537-61.033-25.537s-45.482 9.768-61.024 25.527c-15.661 15.865-25.327 37.661-25.327 61.715 0 24.053 9.667 45.849 25.327 61.715l431.659 436.343c15.523 15.814 37.124 25.615 61.014 25.615s45.491-9.802 61.001-25.602l777.069-785.403c15.624-15.868 25.271-37.66 25.271-61.705s-9.647-45.837-25.282-61.717M1388.020 57.589z",fill:"#6A8FE5","p-id":"1025"})],-1))),h=[m],g={class:"street-name ellipsis"},_={class:"operation-section"},v=["onClick"],f=["data-id","onClick"],b=r((()=>(0,i._)("img",{src:l,alt:""},null,-1))),I=r((()=>(0,i._)("p",null,"使用新地址",-1))),N=[b,I],w={class:"box-inner ui-cart"},k=r((()=>(0,i._)("div",{class:"cart-table-title"},[(0,i._)("span",{class:"name"},"商品信息"),(0,i._)("span",{class:"subtotal"},"小计"),(0,i._)("span",{class:"num"},"数量"),(0,i._)("span",{class:"price"},"单价")],-1))),y={key:0,class:"cart-table"},L=["data-productid"],D={class:"cart-top-items"},x={class:"cart-items clearfix"},C={class:"items-thumb fl"},z=["alt","src"],O=["onClick","title"],P={class:"name hide-row fl"},S={class:"name-table"},W=["onClick","title","textContent"],Z={class:"subtotal",style:{"font-size":"14px"}},$={class:"item-cols-num"},B=["textContent"],U={class:"price"},Y={class:"cart-bottom-bg fix-bottom"},T={class:"fix-bottom-inner"},E={class:"shipping"},H={class:"shipping-box",style:{padding:"0 40px"}},V={class:"shipping-total shipping-price"},q={class:"highlight"},A=["data-id"];function J(s,t,e,l,r,m){const b=(0,i.up)("y-header"),I=(0,i.up)("y-shelf"),J=(0,i.up)("y-button"),M=(0,i.up)("el-checkbox"),Q=(0,i.up)("y-popup"),F=(0,i.up)("y-footer");return(0,i.wg)(),(0,i.iD)("div",n,[(0,i.Wm)(b),(0,i._)("div",u,[(0,i.Wm)(I,{title:"收货信息"},{content:(0,i.w5)((()=>[(0,i._)("ul",c,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.addList,((s,t)=>((0,i.wg)(),(0,i.iD)("li",{key:t,class:(0,d.C_)(["address pr",{checked:r.addressId===s.addressId}]),onClick:t=>m.chooseAddress(s.addressId,s.userName,s.tel,s.streetName)},[r.addressId===s.addressId?((0,i.wg)(),(0,i.iD)("span",p,h)):(0,i.kq)("",!0),(0,i._)("p",null,"收货人: "+(0,d.zw)(s.userName)+" "+(0,d.zw)(s.isDefault?"(默认地址)":""),1),(0,i._)("p",g,"收货地址: "+(0,d.zw)(s.streetName),1),(0,i._)("p",null,"手机号码: "+(0,d.zw)(s.tel),1),(0,i._)("div",_,[(0,i._)("span",{class:"update-btn",style:{"font-size":"12px"},onClick:t=>m.update(s)},"修改",8,v),(0,i._)("span",{class:"delete-btn",style:{"font-size":"12px"},"data-id":s.addressId,onClick:t=>m.del(s.addressId)},"删除",8,f)])],10,o)))),128)),(0,i._)("li",{class:"add-address-item",onClick:t[0]||(t[0]=s=>m.update())},N)])])),_:1}),(0,i.Wm)(I,{title:"购物清单"},{content:(0,i.w5)((()=>[(0,i._)("div",w,[(0,i._)("div",null,[k,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.cartList,((s,t)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:t},["1"===s.checked?((0,i.wg)(),(0,i.iD)("div",y,[(0,i._)("div",{class:"cart-group divide pr","data-productid":s.productId},[(0,i._)("div",D,[(0,i._)("div",x,[(0,i._)("div",C,[(0,i._)("img",{alt:s.productName,src:s.productImg},null,8,z),(0,i._)("a",{onClick:t=>m.goodsDetails(s.productId),title:s.productName,target:"_blank"},null,8,O)]),(0,i._)("div",P,[(0,i._)("div",S,[(0,i._)("a",{onClick:t=>m.goodsDetails(s.productId),title:s.productName,target:"_blank",textContent:(0,d.zw)(s.productName)},null,8,W)])]),(0,i._)("div",null,[(0,i._)("div",Z,"¥ "+(0,d.zw)(s.salePrice*s.productNum),1),(0,i._)("div",$,[(0,i._)("span",{textContent:(0,d.zw)(s.productNum)},null,8,B)]),(0,i._)("div",U,"¥ "+(0,d.zw)(s.salePrice),1)])])])],8,L)])):(0,i.kq)("",!0)],64)))),128))]),(0,i._)("div",Y,[(0,i._)("div",T,[(0,i._)("div",E,[(0,i._)("div",H,[(0,i._)("div",V,[(0,i._)("h4",q,[(0,i.Uk)("应付总额："),(0,i._)("em",null,"￥"+(0,d.zw)(m.checkPrice),1)])])]),(0,i.Wm)(J,{class:"big-main-btn",classStyle:r.submit?"disabled-btn":"main-btn",style:{margin:"0",width:"130px",height:"50px","line-height":"50px","font-size":"16px"},text:r.submitOrder,onBtnClick:m._submitOrder},null,8,["classStyle","text","onBtnClick"])])])])])])),_:1}),(0,i.Wm)(Q,{open:r.popupOpen,onClose:t[6]||(t[6]=s=>r.popupOpen=!1),title:r.popupTitle},{content:(0,i.w5)((()=>[(0,i._)("div",{class:"md","data-id":r.msg.addressId},[(0,i._)("div",null,[(0,i.wy)((0,i._)("input",{type:"text",placeholder:"收货人姓名","onUpdate:modelValue":t[1]||(t[1]=s=>r.msg.userName=s)},null,512),[[a.nr,r.msg.userName]])]),(0,i._)("div",null,[(0,i.wy)((0,i._)("input",{type:"number",placeholder:"手机号码","onUpdate:modelValue":t[2]||(t[2]=s=>r.msg.tel=s)},null,512),[[a.nr,r.msg.tel]])]),(0,i._)("div",null,[(0,i.wy)((0,i._)("input",{type:"text",placeholder:"收货地址","onUpdate:modelValue":t[3]||(t[3]=s=>r.msg.streetName=s)},null,512),[[a.nr,r.msg.streetName]])]),(0,i._)("div",null,[(0,i.Wm)(M,{class:"auto-login",modelValue:r.msg.isDefault,"onUpdate:modelValue":t[4]||(t[4]=s=>r.msg.isDefault=s)},{default:(0,i.w5)((()=>[(0,i.Uk)("设为默认")])),_:1},8,["modelValue"])]),(0,i.Wm)(J,{text:"保存",class:"btn",classStyle:m.btnHighlight?"main-btn":"disabled-btn",onBtnClick:t[5]||(t[5]=s=>m.save({userId:r.userId,addressId:r.msg.addressId,userName:r.msg.userName,tel:r.msg.tel,streetName:r.msg.streetName,isDefault:r.msg.isDefault}))},null,8,["classStyle"])],8,A)])),_:1},8,["open","title"])]),(0,i.Wm)(F)])}e(2575);var M=e(9956),Q=e(4154),F=e(2778),K=e(1923),j=e(5229),G=e(2362),R=e(3529),X={data(){return{cartList:[],addList:[],addressId:"0",popupOpen:!1,popupTitle:"管理收货地址",num:"",productId:"",msg:{addressId:"",userName:"",tel:"",streetName:"",isDefault:!1},userName:"",tel:"",streetName:"",userId:"",orderTotal:0,submit:!1,submitOrder:"提交订单"}},computed:{btnHighlight(){let s=this.msg;return s.userName&&s.tel&&s.streetName},checkPrice(){let s=0;return this.cartList&&this.cartList.forEach((t=>{"1"===t.checked&&(s+=t.productNum*t.salePrice)})),s}},methods:{message(s){this.$message.error({message:s})},goodsDetails(s){window.open(window.location.origin+"#/goodsDetails?productId="+s)},_getCartList(){this.cartList=JSON.parse((0,R.bh)("buyCart"))},_addressList(){this.addList=JSON.parse((0,R.bh)("addList"))||[],this.addressId=this.addList[0]?.addressId||"1",this.userName=this.addList[0].userName,this.tel=this.addList[0].tel},_addressUpdate(s){if(!/^\d{11}$/g.test(s.tel))return this.message("请输入11位电话号码"),!1;this.addList.forEach((t=>{t.addressId===s.addressId?(t.tel=s.tel,t.userName=s.userName,t.isDefault=s.isDefault,t.streetName=s.streetName):s.isDefault&&(t.isDefault=!1)})),(0,R.PQ)("addList",JSON.stringify(this.addList))},_addressAdd(s){if(!/^\d{11}$/g.test(s.tel))return this.message("请输入11位电话号码"),!1;s.isDefault&&this.addList.forEach((s=>s.isDefault=!1)),this.addList.push({userId:this.userId,addressId:this.addList.length+1,userName:s.userName,tel:s.tel,isDefault:s.isDefault,streetName:s.streetName}),(0,R.PQ)("addList",JSON.stringify(this.addList))},_addressDel(s){let t=-1;this.addList.forEach(((e,i)=>{e.addressId===s.addressId&&(t=i)})),this.addList.splice(t,1),this.addList.forEach(((s,t)=>{s.addressId=t+1})),(0,R.PQ)("addList",JSON.stringify(this.addList))},_submitOrder(){this.submitOrder="提交订单中...",this.submit=!0;var s=[];if("0"===this.addressId)return this.message("请选择收货地址"),this.submitOrder="提交订单",void(this.submit=!1);if(0===this.cartList.length)return this.message("非法操作"),this.submitOrder="提交订单",void(this.submit=!1);for(var t=0;t<this.cartList.length;t++)"1"===this.cartList[t].checked&&s.push(this.cartList[t]);let e={userId:this.userId,tel:this.tel,userName:this.userName,streetName:this.streetName,goodsList:s,orderTotal:this.orderTotal};(0,M.pm)(e).then((s=>{!0===s.success?this.payment(s.result):(this.message(s.message),this.submitOrder="提交订单",this.submit=!1)}))},payment(s){this.$router.push({path:"/order/payment",query:{orderId:s}})},chooseAddress(s,t,e,i){this.addressId=s,this.userName=t,this.tel=e,this.streetName=i},update(s){this.popupOpen=!0,s?(this.popupTitle="管理收货地址",this.msg.userName=s.userName,this.msg.tel=s.tel,this.msg.streetName=s.streetName,this.msg.isDefault=s.isDefault,this.msg.addressId=s.addressId):(this.popupTitle="新增收货地址",this.msg.userName="",this.msg.tel="",this.msg.streetName="",this.msg.isDefault=!1,this.msg.addressId="")},save(s){this.popupOpen=!1,s.addressId?this._addressUpdate(s):(delete s.addressId,this._addressAdd(s))},del(s){this._addressDel({addressId:s})},_productDet(s){(0,M.rz)({params:{productId:s}}).then((s=>{let t=s.result;t.checked="1",t.productImg=t.productImageBig,t.productNum=this.num,t.productPrice=t.salePrice,this.cartList.push(t)}))}},created(){this.userId=(0,R.bh)("userId");let s=this.$route.query;s.productId&&s.num?(this.productId=s.productId,this.num=s.num,this._productDet(this.productId)):this._getCartList(),this._addressList()},components:{YShelf:Q.Z,YButton:F.Z,YPopup:K.Z,YHeader:j.Z,YFooter:G.Z}},ss=e(963);const ts=(0,ss.Z)(X,[["render",J],["__scopeId","data-v-1d0fb24c"]]);var es=ts}}]);
//# sourceMappingURL=722.71901c4e.js.map